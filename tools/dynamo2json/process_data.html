<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<title>CSV to JSON</title>
		<style>
			.error { font-weight: bold; color: #F00; }
		</style>
        <script src="http://ajax.cdnjs.com/ajax/libs/json2/20110223/json2.js"> </script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"> </script>
        <script src="/socket.io/socket.io.js"></script>
	</head>
	<body>
		<p>Notes:</p>
		<ul>
			<li>The CSV text <strong style="text-transform: uppercase; ">must</strong> have a header row.</li>
			<li>This utility does not currently check for escaped quotes inside of like quotes (e.g.: <code>"foo, \"bar\" baz"</code>).</li>
		</ul>
		<hr noshade="noshade" />
		<div id="message"><p></p></div>
		<form id="convertForm" name="convertForm" onsubmit="return false; ">
			<label title="JavaScript Object Notation">Output JSON for VeriteCo timeline control:</label><br/>
            <textarea id="json_courses_text" name="json courses text" rows="10" cols="60" readonly="readonly"></textarea><br/><br/>
            <label title="JavaScript Object Notation">Course providers/streams JSON for VeriteCo timeline control:</label><br/>
            <textarea id="json_helper_text" name="json helper text" rows="10" cols="60" readonly="readonly"></textarea><br/><br/>
            <input type="button" value="Convert" id="transform_data"/>
            <input type="reset"/>
		</form>
	</body>
    <footer>
        <script>
            var socket = io.connect('http://localhost');

            $("#transform_data").click(function() {
                socket.emit('get_veriteco_data');
            })

            socket.on('veriteco_data', function (data) {
                console.log(data);
                text=JSON.stringify(data.courses);
                $("#json_courses_text").val(text);
                textInfo=JSON.stringify(data.helper);
                $("#json_helper_text").val("var CDData = " + textInfo);
            });
        </script>
    </footer>
</html>